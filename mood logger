import datetime
import os

FILE_NAME = "moods.txt"


def clear_screen():
    os.system("clear")


def save_mood(mood: str) -> None:
    today = datetime.date.today().strftime("%Y-%m-%d")
    with open(FILE_NAME, "a", encoding="utf-8") as f:
        f.write(f"{today} | {mood.strip()}\n")


def read_moods() -> list[str]:
    if not os.path.exists(FILE_NAME):
        return []
    with open(FILE_NAME, "r", encoding="utf-8") as f:
        lines = [line.strip() for line in f.readlines() if line.strip()]
    return lines


def show_moods() -> None:
    logs = read_moods()
    if not logs:
        print("üòå ‡¶è‡¶ñ‡¶®‡¶ì ‡¶ï‡ßã‡¶®‡ßã mood log ‡¶®‡¶æ‡¶á‡•§ ‡¶Ü‡¶ó‡ßá mood add ‡¶ï‡¶∞‡ßã!\n")
        return

    print("üìñ Mood History:\n")
    for line in logs[-30:]:
        print("‚Ä¢", line)
    print("\n(‡¶∂‡ßá‡¶∑ ‡ß©‡ß¶‡¶ü‡¶æ ‡¶è‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã ‡¶π‡¶≤‡ßã)\n")


def show_stats() -> None:
    logs = read_moods()
    if not logs:
        print("üìä Stats ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã‡¶∞ ‡¶Æ‡¶§‡ßã ‡¶ï‡ßã‡¶®‡ßã data ‡¶®‡¶æ‡¶á‡•§\n")
        return

    total = len(logs)
    today = datetime.date.today().strftime("%Y-%m-%d")
    today_count = sum(1 for x in logs if x.startswith(today))

    print("üìä Quick Stats:\n")
    print(f"‚Ä¢ Total logs: {total}")
    print(f"‚Ä¢ Today's logs ({today}): {today_count}\n")


def main():
    while True:
        clear_screen()
        print("üß† Daily Mood Log (Python CLI)")
        print("-" * 28)
        print("1) Add today's mood")
        print("2) View mood history")
        print("3) View quick stats")
        print("4) Exit\n")

        choice = input("Choose (1/2/3/4): ").strip()

        clear_screen()

        if choice == "1":
            mood = input("‡¶Ü‡¶ú‡¶ï‡ßá ‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ mood ‡¶ï‡ßá‡¶Æ‡¶®? (ex: happy / meh / sad / tired): ")
            if mood.strip():
                save_mood(mood)
                print("\n‚úÖ Mood saved!\n")
            else:
                print("\n‚ùå ‡¶ñ‡¶æ‡¶≤‡¶ø mood save ‡¶π‡¶¨‡ßá ‡¶®‡¶æ‡•§\n")

        elif choice == "2":
            show_moods()

        elif choice == "3":
            show_stats()

        elif choice == "4":
            print("üëã Bye! ‡¶≠‡¶æ‡¶≤‡ßã ‡¶•‡ßá‡¶ï‡ßã.\n")
            break

        else:
            print("‚ùå Invalid choice. ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßã‡•§\n")

        input("Press Enter to continue...")


if __name__ == "__main__":
    main()
